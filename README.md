# 楽天市場価格追跡アプリケーション

このアプリケーションは、楽天市場の商品価格を追跡し、Gemini AIを使用した価格予測機能と、目標価格到達時のメール通知機能を提供します。

## 主な機能

1. 楽天市場商品URLから価格履歴を取得
2. 価格推移のグラフ表示（Plotlyを使用）
3. Gemini AIを使用した価格予測
4. メール通知機能（目標価格に達した際に通知）
5. リアルタイムのローディング進捗表示
6. 定期的な価格チェックと自動通知（APSchedulerを使用）
7. アニメーションによる視覚的なフィードバック（Anime.jsを使用）

## ファイル構成

- `app.py`: メインのFlaskアプリケーション。ルーティング、ビューロジック、メール通知機能、スケジューラー設定を含む。
- `price_tracker.py`: 楽天市場APIを使用して価格データと商品画像を取得。キーワード抽出、価格履歴の保存と読み込みを行う。
- `price_predictor.py`: Gemini AIを使用して価格予測を行うロジックを含む。
- `static/`:
  - `style.css`: アプリケーション全体のスタイルを定義するCSSファイル。
  - `animations.js`: ローディングアニメーションやボタンのインタラクションを制御するJavaScriptファイル。
- `templates/`:
  - `base.html`: 基本的なHTMLテンプレート。他のテンプレートの基礎となる。
  - `index.html`: メインページのテンプレート。商品URL入力フォームを含む。
  - `result.html`: 価格追跡結果を表示するページのテンプレート。グラフ、予測価格、商品画像、メール通知設定フォームを表示。
  - `email_sent.html`: メール通知設定完了ページのテンプレート。
  - `error.html`: エラーメッセージを表示するページのテンプレート。
- `requirements.txt`: プロジェクトの依存関係を列挙したファイル。

## セットアップ手順

1. リポジトリをクローンします：
   ```
   git clone https://github.com/your-username/rakuten-price-tracker.git
   cd rakuten-price-tracker
   ```

2. 必要なPythonパッケージをインストールします：
   ```
   pip install -r requirements.txt
   ```

3. 環境変数を設定します：
   - `RAKUTEN_APP_ID`と`RAKUTEN_AFFILIATE_ID`を設定します（楽天APIの使用に必要）。
   - `GOOGLE_API_KEY`を設定します（Gemini AIのAPIキー）。
   - メール通知用のSMTP設定を行います：
     ```
     export SMTP_SERVER=your_smtp_server
     export SMTP_PORT=your_smtp_port
     export SMTP_USERNAME=your_email@example.com
     export SMTP_PASSWORD=your_email_password
     ```

4. アプリケーションを実行します：
   ```
   python app.py
   ```

## 使用方法

1. ブラウザで `http://localhost:8080` にアクセスします。
2. 楽天市場商品のURLを入力し、「追跡開始」をクリックします。
3. 価格履歴、現在の価格、Gemini AIによる予測価格が表示されます。
4. 目標価格とメールアドレスを入力して、メール通知を設定できます。

## 最近の更新

- リアルタイムのローディング進捗表示機能を追加
- メール通知設定時のバリデーションを強化
- エラーハンドリングとエラーページの改善
- ユーザーインターフェースの全体的な改善（アニメーション、スタイリング）
- 定期的な価格チェックと自動通知機能の実装（APSchedulerを使用）
- ヘッダーにホームページへのリンクを追加（メール送信完了ページと価格追跡結果ページ）

## 注意事項

- このアプリケーションは開発環境用です。本番環境での使用には、セキュリティ強化が必要です。
- 楽天市場APIとGemini AIの使用には制限があります。各サービスの利用規約を確認してください。
- 価格履歴データは、アプリケーションを定期的に実行することで蓄積されます。
- 現在、データはJSONファイルで保存されています。大規模な運用には、データベースの使用を検討してください。
- Gemini AIによる予測は、十分なデータがない場合、一般的な傾向や推奨事項を提供します。
- メール通知機能を使用する場合は、SMTPサーバーの設定が必要です。セキュリティに注意してください。
- アプリケーションが常に稼働している必要があります（定期的な価格チェックのため）。

## 今後の改善点

- データベースの導入（SQLiteからより堅牢なデータベースへの移行）
- ユーザー認証システムの実装
- より詳細な価格分析と予測機能の追加
- モバイルアプリケーションの開発

## ライセンス

このプロジェクトは、MITライセンスの下で公開されています。

## 貢献

バグ報告や機能リクエストは、Issueを通じてお知らせください。プルリクエストも歓迎します。

---

最終更新日: 2024年10月23日
